<html>
<head id="head">
<script src="mvc.js"></script>
<script src="uri.js"></script>
<script>

var context  = {
	data : 'posts.json',
	view : 'posts.view.js',
	id   : 'main'
};

var context2 = {
	data : 'posts.json' ,
	view : 'post.view.js',
	id   : 'post'
};

window.onload = function(){
	var dec = decompose(document.URL);

	// Compile view for a post
	if(dec.pars){		
		context2.redutor = {
			init : null,
			redutor : function(res, item){
							if(item.id == dec.pars.post_id){ 
								return item; 
							} 
							return res; 
						}
		};
		compile(context2);
		return;
	}

	// Compile view for listing posts
	compile(context);
}

window.onpopstate = function(event){
	console.log('onpopstate');
	if(event.state){
		console.log('clean compile ...');
		cleanCompile(event.state);	
	}
}

</script>
</head>
<body id="body">
</body>
</html>